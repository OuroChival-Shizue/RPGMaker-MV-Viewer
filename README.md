# RPGMaker-MV-Viewer 地图解析与攻略生成器

一个轻量级的 RPG Maker MV 游戏辅助工具。它能够读取游戏数据文件，在 Web 界面中 1:1 还原地图与事件，并提供“上帝视角”的事件解析、数据搜索及 Markdown 攻略一键导出功能。

无需打开庞大的 RPG Maker 编辑器，也不需要运行游戏跑图，即可直接查看宝箱内容、触发条件、NPC 对话及传送逻辑。

---

## ✨ 核心功能 (Features)

*   **🗺️ 交互式地图浏览器**
    *   基于 HTML5 Canvas 的地图渲染。
    *   支持拖拽、缩放、点击交互。
    *   **通行度叠加 (Passability Overlay)**：直观查看地图的可行走区域。

*   **🔍 深度事件解析 (Deep Event Analysis)**
    *   **智能翻译**：将 RM 的数字指令（Code）自动翻译为人类可读的文本。
    *   **自动分类**：自动识别并标记 宝箱 (Treasure)、传送 (Transfer)、战斗 (Battle)、对话 (Dialog) 等事件类型。
    *   **条件透视**：直接显示事件触发所需的开关 (Switch)、变量 (Variable) 或 物品 (Item) 条件。

*   **📝 攻略一键导出 (Walkthrough Generator)**
    *   支持将单张地图或全部地图的事件信息导出为 **Markdown** 格式。
    *   自动整理关键道具、NPC 对话及传送点信息，极大降低攻略制作成本。

*   **📚 全局数据检索**
    *   内置全局搜索引擎，快速查找物品、怪物或特定剧情文本。
    *   提供游戏数据库图鉴（物品、武器、敌人等 ID 映射表）。

---

## 🛠️ 技术架构 (Architecture)

本项目采用 **Python + HTML/JS** 的轻量级架构：

*   **后端**：基于 Python 标准库 `http.server`，无第三方重依赖。
    *   `DatabaseManager`: 负责解析 `www/data/` 下的 JSON 数据并建立 ID 映射。
    *   `EventInterpreter`: 核心解释器，负责将事件指令流转化为结构化信息。
*   **前端**：嵌入式单页应用 (SPA)。
    *   三栏布局：地图树 | 画布 | 详情面板。
    *   通过 RESTful API 与后端交互。

---

## 🚀 快速开始 (Getting Started)

### 前置要求
*   Python 3.x
*   目标 RPG Maker MV 游戏的 `www` 资源目录

### 安装与运行
1.  将脚本文件（如 `rpgmv_viewer.py`）放置在游戏根目录下（确保能读取到 `www/data/MapInfos.json`）。
2.  在终端或命令行运行：
    ```bash
    python rpgmv_viewer.py
    ```
3.  程序将自动启动本地服务器，并打开浏览器访问 `http://127.0.0.1:<PORT>`。

---

## 📖 使用指南 (Usage)

1.  **浏览地图**：左侧目录树选择地图，中间画布查看。
2.  **查看事件**：点击地图上标有图标的格子（宝箱、NPC等），右侧面板将显示详细逻辑。
    *   *蓝色链接*：点击可跳转查看引用的公共事件或传送目标。
3.  **检查通行度**：在顶部菜单勾选 "Show Passability" 查看地形阻挡。
4.  **导出攻略**：点击右上角的 "Export Markdown"，获取当前地图的详细攻略文本。

---

## 🔌 API 参考 (API Reference)

对于开发者，你可以直接调用后端 API 获取 JSON 数据：

| Method | Endpoint | Description |
| :--- | :--- | :--- |
| `GET` | `/api/tree` | 获取地图树结构 |
| `GET` | `/api/map/<id>` | 获取指定地图数据及解析后的事件 |
| `GET` | `/api/search?q=...` | 全局搜索关键词 |
| `GET` | `/api/common_event/<id>` | 解析公共事件 |
| `GET` | `/api/export?map=<id>` | 导出单张地图攻略 (Markdown) |

---

## ⚠️ 常见问题 (Troubleshooting)

*   **无法启动？**
    *   请确保脚本运行目录下存在 `www/data/MapInfos.json` 文件。
*   **地图显示为空白？**
    *   检查浏览器控制台 (F12) 是否有网络请求错误。
    *   确保端口未被占用。
*   **解析结果显示 `<Unknown>`？**
    *   可能是部分加密资源或非标准插件数据，请检查控制台警告日志。

---

## 📄 License

此项目仅供学习与攻略制作辅助使用，请勿用于破解或非法分发商业游戏资源。

---
*Generated by RPGMV Map Inspector*
